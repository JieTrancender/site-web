---
title: "一条SQL更新语句是如何执行的 MySQL学习笔记二"
date: 2022-02-18T12:38:59+08:00
tags: ["MySQL"]
categories: ["MySQL"]
toc: false
draft: false
---

更新语句同样会走一遍查询语句的那一套流程，即客户端、连接器、分析器、优化器、执行器、存储引擎等。表更新的时候会将该表有关的查询缓存情况，所以建议一般不使用查询缓存。

与查询你流程不一样的是更新流程还设计两个重要的日志模块，redo log（重做日志）和binlog（归档日志）。

#### redo log

在MySQL里，如果每一次的更新操作都需要写进磁盘，磁盘找到对应的那条记录更新，整个过程IO成本很高、查询成本都很高。为了解决这个问题设计了redo log。

MySQL里经常说到的WAL技术（Write-Ahread Logging），**关键点就是先写日志，再写磁盘**。具体来说当有一条记录需要更新的时候，InnoDB引擎会先把记录写到redo log里面并更新内存。InnoDB引擎在适当的时候再将这个操作记录更新到磁盘里面，往往在系统比较空闲的时候做。

